<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ARMY Training Camp</title>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; padding: 20px; text-align: center; }
        h1 { color: #AB46D2; }
        #progress-container { width: 100%; background: #333; height: 20px; border-radius: 10px; margin: 20px 0; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: #AB46D2; transition: width 0.3s; }
        .song-list { text-align: left; max-width: 400px; margin: 0 auto; }
        .song-item { padding: 10px; border-bottom: 1px solid #333; display: flex; align-items: center; }
        /* è®“è¢«ç¦ç”¨çš„ checkbox çœ‹èµ·ä¾†æš—ä¸€é» */
        .song-item input:disabled { opacity: 0.6; cursor: not-allowed; }
        .song-item input { margin-right: 15px; transform: scale(1.5); accent-color: #AB46D2; }
        #btn-cert { background: #444; color: #888; border: none; padding: 15px; border-radius: 50px; width: 100%; margin-top: 20px; font-size: 18px; }
        #btn-cert.unlocked { background: linear-gradient(45deg, #AB46D2, #5a189a); color: white; cursor: pointer; box-shadow: 0 0 20px #AB46D2; }
        
        /* è­‰æ›¸æ¨£å¼ */
        #certificate-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); flex-direction: column; justify-content: center; align-items: center; z-index: 999; }
        #cert-card { background: #000; border: 4px solid #AB46D2; padding: 20px; border-radius: 15px; width: 80%; text-align: center; }
        .close-btn { margin-top: 20px; background: transparent; border: 1px solid #fff; color: white; padding: 5px 20px; border-radius: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ’œ ç‰¹è¨“ä¸­å¿ƒ</h1>
    <a href="index.html" style="color:#888; text-decoration:none;">â† å›é¦–é </a>
    <br><br>
    <input type="text" id="army-name" placeholder="è¼¸å…¥æš±ç¨±" style="padding:10px; border-radius:5px; border:1px solid #AB46D2; background:#222; color:#fff;">
    
    <div id="progress-container"><div id="progress-bar"></div></div>
    <div id="progress-text">0 / 42</div>

    <div class="song-list">
        <label class="song-item"><input type="checkbox" id="song-1" disabled> 1. Mic Drop</label>
        
        <label class="song-item"><input type="checkbox" id="song-2"> 2. DNA (è‡ªä¸»ç·´ç¿’)</label>
    </div>

    <button id="btn-cert" disabled>ğŸ”’ é ˜å–è­‰æ›¸</button>

    <div id="certificate-overlay">
        <div id="cert-card">
            <h2>CERTIFICATE</h2>
            <div style="font-size:40px;">ğŸ…</div>
            <p>This certifies that</p>
            <h1 id="cert-name" style="color:#AB46D2;">ARMY</h1>
            <p>Has completed the training.</p>
            <p id="cert-date" style="font-size:12px; color:#888;"></p>
        </div>
        <p style="color:#fff;">è«‹æˆªåœ–åˆ†äº« âœ¨</p>
        <button class="close-btn" onclick="document.getElementById('certificate-overlay').style.display='none'">é—œé–‰</button>
    </div>

    <script>
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const btnCert = document.getElementById('btn-cert');
        const nameInput = document.getElementById('army-name');

        // 1. è®€å– Mic Drop çš„è‡ªå‹•è¨ˆæ•¸
        const micDropCount = parseInt(localStorage.getItem('mic_drop_count') || '0');
        
        // 2. è™•ç† Mic Drop ç‹€æ…‹ (å®Œå…¨è‡ªå‹•åŒ–é‚è¼¯)
        const micDropBox = document.getElementById('song-1');
        const micDropLabel = micDropBox.parentElement;

        // åŠ å…¥é€²åº¦æ–‡å­—
        const span = document.createElement('span');
        span.style.fontSize = '12px';
        span.style.color = '#AB46D2';
        span.style.marginLeft = '10px';
        
        // ğŸ”´ é€™è£¡æ±ºå®šæ˜¯å¦æ‰“å‹¾ï¼Œç„¡è¦–ä»»ä½•æ‰‹å‹•ç´€éŒ„
        if (micDropCount >= 3) {
            span.innerText = "âœ… å¤§å¸« (3/3)";
            micDropBox.checked = true; // ç³»çµ±å¹«ä½ å‹¾
        } else {
            span.innerText = `ğŸ”’ ç´¯ç©: ${micDropCount}/3`;
            micDropBox.checked = false; // å¼·åˆ¶ä¸å‹¾
        }
        micDropLabel.appendChild(span);

        function updateUI() {
            const checked = document.querySelectorAll('input:checked').length;
            const total = checkboxes.length;
            const percent = total === 0 ? 0 : (checked / total) * 100;
            
            progressBar.style.width = percent + "%";
            progressText.innerText = `å·²å®Œæˆ ${checked} / ${total}`;
            
            if (percent === 100) {
                btnCert.disabled = false;
                btnCert.classList.add('unlocked');
                btnCert.innerText = "ğŸ† é ˜å–è­‰æ›¸";
            } else {
                btnCert.disabled = true;
                btnCert.classList.remove('unlocked');
                btnCert.innerText = "ğŸ”’ é ˜å–è­‰æ›¸";
            }
            
            // å­˜æª” (åªå­˜é‚£äº›å…è¨±æ‰‹å‹•çš„é …ç›®)
            const data = {};
            checkboxes.forEach(box => {
                if (!box.disabled) { // åªå­˜æ²’è¢«é–ä½çš„
                    data[box.id] = box.checked;
                }
            });
            localStorage.setItem('army_progress', JSON.stringify(data));
            localStorage.setItem('army_name', nameInput.value);
        }

        // 3. è®€å– *å…¶ä»–* æ‰‹å‹•é …ç›®çš„æ­·å² (æ’é™¤ Mic Drop)
        const savedData = JSON.parse(localStorage.getItem('army_progress')) || {};
        checkboxes.forEach(box => {
            // å¦‚æœæ˜¯ Mic Dropï¼Œç›´æ¥è·³éï¼Œå› ç‚ºä¸Šé¢å·²ç¶“ç”± micDropCount æ±ºå®šäº†
            if (box.id === 'song-1') return; 

            if (savedData[box.id]) box.checked = true;
            
            // ç›£è½è®Šæ›´ (åªå°æ‰‹å‹•é …ç›®æœ‰æ•ˆ)
            box.addEventListener('change', updateUI);
        });

        nameInput.value = localStorage.getItem('army_name') || "";
        nameInput.addEventListener('input', updateUI);
        
        // åˆå§‹åŒ– UI
        updateUI();

        btnCert.addEventListener('click', () => {
            document.getElementById('cert-name').innerText = nameInput.value || "ARMY";
            document.getElementById('cert-date').innerText = new Date().toLocaleDateString();
            document.getElementById('certificate-overlay').style.display = 'flex';
        });
    </script>
</body>
</html>
